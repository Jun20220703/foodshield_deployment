<div class="page-layout">
  <!-- Sidebar -->
  <app-sidebar></app-sidebar>
  
  <!-- Main Content -->
  <div class="main-content">
    <div class="meal-planning-container">
      <!-- Calendar View Section -->
      <div class="calendar-section">
    <h2 class="section-title">Calendar View</h2>
    <div class="calendar-container">
      <div class="month-header">
        <button class="nav-arrow" (click)="previousMonth($event)">‚Äπ</button>
        <span class="month-name">{{ currentMonth }}</span>
        <button class="nav-arrow" (click)="nextMonth($event)">‚Ä∫</button>
      </div>
      
      <div class="week-days">
        <button class="week-nav-arrow left" (click)="previousDay($event)" title="Previous day">‚Äπ</button>
        <div class="day-column" *ngFor="let day of weekDays">
          <div class="day-card" [class.past-day]="day.isPast">
            <div class="day-header">
              <div class="day-name">{{ day.name }}</div>
              <div class="day-number" [class.today]="day.isToday">{{ day.date }}</div>
            </div>
            <div class="meal-slots">
              <div class="meal-slot" *ngFor="let meal of mealTypes" 
                   (click)="selectMealSlot(day, meal)"
                   [class.has-meal]="hasMeal(day, meal)"
                   [class.selected]="selectedDay && selectedDay.fullDate.getTime() === day.fullDate.getTime() && selectedMealType === meal">
                <div class="meal-indicator"></div>
                <div class="meal-name">{{ meal }}</div>
                <div class="meal-content" *ngIf="hasMeal(day, meal)">
                  {{ getMealName(day, meal) }}
                </div>
              </div>
            </div>
          </div>
        </div>
        <button class="week-nav-arrow right" (click)="nextDay($event)" title="Next day">‚Ä∫</button>
      </div>
      
      <!-- Meal Options inside calendar container -->
      <div class="meal-options-section" *ngIf="showMealOptions">
        <div class="meal-options-header">
          <h3>No meals added...</h3>
        </div>
        <div class="meal-options-content">
          <div class="meal-option-card add-own" 
               [class.disabled]="isPastDateSelected()"
               (click)="!isPastDateSelected() && addOwnMeal($event)">
            <div class="option-question">Do you want to add your own meal?</div>
            <button class="option-button" 
                    type="button" 
                    [disabled]="isPastDateSelected()"
                    (click)="addOwnMeal($event); $event.stopPropagation()">Add</button>
          </div>
          <div class="meal-option-card browse" 
               [class.disabled]="isPastDateSelected()"
               (click)="!isPastDateSelected() && browseRecipes($event)">
            <div class="option-question">Do you want to browse more recipes?</div>
            <button class="option-button" 
                    type="button" 
                    [disabled]="isPastDateSelected()"
                    (click)="browseRecipes($event); $event.stopPropagation()">Browse</button>
          </div>
        </div>
        <div class="close-options-wrapper">
          <button class="close-options-button" (click)="closeMealOptions()" title="Close options">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M18 15L12 9L6 15" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Marked Foods Section -->
  <div class="inventory-section">
    <div class="inventory-header">
      <h2 class="section-title">Marked Foods</h2>
      <div class="search-filter-bar">
        <input 
          type="text" 
          class="search-input" 
          placeholder="Food item Name"
          [(ngModel)]="searchTerm"
          (input)="filterInventory()">
        <button class="search-btn" (click)="filterInventory()">
          <span class="search-icon">üîç</span>
        </button>
        <button class="filter-btn" (click)="toggleFilter()">
          <span class="filter-icon">‚ò∞</span>
        </button>
      </div>
    </div>

    <div class="inventory-container">
      <div class="table-headers">
        <div class="header-cell">Name</div>
        <div class="header-cell">Quantity</div>
        <div class="header-cell">Category</div>
        <div class="header-cell">Mark</div>
        <div class="header-cell">Marked Quantity</div>
        <div class="header-cell">Expiry</div>
      </div>

      <div class="inventory-list">
        <div 
          class="inventory-item" 
          *ngFor="let item of paginatedInventory; let i = index"
          [class.selected]="selectedItemIndex === i"
          (click)="selectItem(i)">
          <div class="item-name">{{ item.name }}</div>
          <div class="item-quantity">
            <span class="quantity-circle">{{ item.quantity }}</span>
          </div>
          <div class="item-category">
            <span class="category-badge" [class]="'category-' + item.category.toLowerCase()">
              <span class="category-icon">{{ getCategoryIcon(item.category) }}</span>
              {{ item.category }}
            </span>
          </div>
          <div class="item-mark">
            <span *ngIf="item.marked" class="marked-badge">
              <span class="checkmark">‚úì</span>
              Marked
            </span>
          </div>
          <div class="item-marked-quantity">
            <span *ngIf="item.markedQuantity > 0" class="marked-quantity-badge">
              {{ item.markedQuantity }}
            </span>
            <span *ngIf="item.markedQuantity === 0" class="no-marked-quantity">-</span>
          </div>
          <div class="item-expiry">
            <span class="expiry-date">{{ item.expiry }}</span>
          </div>
        </div>
      </div>
      
      <!-- Pagination Controls -->
      <div class="pagination-container" *ngIf="totalPages > 1">
        <div class="pagination-buttons">
          <button 
            *ngFor="let page of getPagesArray()" 
            class="page-button"
            [class.active]="currentPage === page"
            (click)="goToPage(page)">
            {{ page }}
          </button>
        </div>
      </div>
      </div>
    </div>
  </div>

</div>

